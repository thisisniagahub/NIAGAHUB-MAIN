# âš–ï¸ ANTIGRAVITY_RULES.md: THE CONSTITUTION

> **GOVERNING LAWS FOR AI AGENTS**
> This file defines the **STANDARD OF EXCELLENCE**.
> All code generated by Antigravity must adhere to these rules.
> **VIOLATION = SYSTEM FAILURE.**

---

## 1. ðŸ›¡ï¸ THE PRIME DIRECTIVES (Safety)

1. **NON-DESTRUCTIVE DEFAULT:**
    * NEVER delete the "Reference Folders" (`NIAGA-HUB-APPS`, `clawd`, etc).
    * Always BACKUP before a destructive `WRITE` on `niagaos`.
2. **ZERO-TRUST ARCHITECTURE:**
    * Frontend (`apps/web`) **NEVER** accesses existing DB secrets.
    * All API calls must go through `apps/ai-gateway` or `apps/api`.
    * No Hardcoded Secrets. Use `.env`.
3. **USER CONSENT:**
    * Any migration of "Money" or "Data" > 1MB requires explicit User Confirmation.

---

## 2. ðŸ’» CODING STANDARDS (The Platinum Tier)

### A. TypeScript Sanctity

* **Rule:** `Strict Mode: ON`.
* **Ban:** No `any`. Use `unknown` or define a generic `<T>`.
* **Validation:** All inputs must be validated with **Zod**.

    ```typescript
    // BAD
    function process(data: any) { ... }
    
    // GOOD
    import { z } from 'zod';
    const Schema = z.object({ id: z.string() });
    function process(data: z.infer<typeof Schema>) { ... }
    ```

### B. The "Gempak" UI Standard (React 19)

* **Styling:** Tailwind CSS 4.0 ONLY. No CSS modules.
* **Structure:** Desktop-First, but Mobile-Responsive (Hidden classes).
* **Animation:** Use `framer-motion` for "wow" factor entry/exit.
* **Components:** Must use `packages/ui` (Shared Library). Do not hardcode `<button>` in pages.

### C. Backend Robustness (Node 22)

* **Error Handling:** Use a centralized `AppError` class.
* **Async:** Always use `try/catch` or `express-async-errors`.
* **Logging:** JSON structured logs (Pino/Winston) for AI parsing.

---

## 3. ðŸ§  AGENT BEHAVIOR PROTOCOLS

### A. The "Sequential Thinking" Rule

* **Trigger:** Complex Logic or Debugging.
* **Action:** MUST usage `@mcp:sequential-thinking` before writing code.
* **Why:** "Measure twice, cut once."

### B. The "Proactive Fix" Rule

* **Trigger:** You see "ugly" legacy code while working on something else.
* **Action:** Refactor it immediately (Boy Scout Rule). "Leave the code better than you found it."

### C. The "Context Awareness" Rule

* **Start:** Always read `AI_CONTEXT_MASTER.md` first.
* **Check:** Read `task.md` to see where the previous agent left off.
* **End:** Update `task.md` and `walkthrough.md` before signing off.

---

## 4. ðŸ“ FILE SYSTEMS & PATHS

1. **Absolute Paths:** Always use `g:\NIAGAHUB-MAIN\...`
2. **Kebab-Case:** All filenames must be `kebab-case.ts` (e.g., `user-profile.ts`).
3. **Barrel Exports:** Use `index.ts` to export folder contents for cleaner imports.

---

## 5. ðŸš€ DEFINITION OF DONE

A task is ONLY complete when:

1. [ ] Code is written.
2. [ ] Code compiles (`pnpm build` passes).
3. [ ] Lint check passes.
4. [ ] Documentation (`.md`) is updated.
5. [ ] User is notified.

> **SIGNED:**
> *Antigravity AI System, 2026*
